# AGENTS.md

## 지침 인식 및 처리 원칙 (최상위 필수)

> **CRITICAL INSTRUCTION FOR AI**
> 이 파일(`AGENTS.md`)의 내용은 단순한 참고 자료가 아니라, 작업 수행 시 반드시 따라야 할 **절대적인 행동 강령(Code of Conduct)**이다.
>
> 1. **전체 정독 필수 (No Summarization)**: 본 문서를 처리할 때 효율성이나 토큰 제한을 이유로 내용을 **요약(Summarize), 축약, 또는 임의로 생략(Skip)**해서는 안 된다.
> 2. **원문 그대로 이행**: 파일의 첫 줄부터 마지막 줄까지 명시된 모든 제약조건, 금지사항, 문서 관리 규칙(`notes.md`, `README.md` 갱신 등)을 **원문 그대로(Verbatim)** 인지하고 엄수해야 한다.
> 3. **절차적 완전성**: 사용자의 요청을 수행하기 전에, 이 문서에 정의된 모든 "사전 확인 절차"와 "사후 기록 절차"가 메모리에 로드되었는지 스스로 검증하라.
> 4. **부분 누락은 실패**: 지침의 일부라도 누락하고 작업을 진행하는 것은 **작업 실패**로 간주한다.

---

## 프로젝트 정보 및 명령어 (필수)

> **Agent Note**
> 현재 작업 디렉터리의 파일을 기준으로 프로젝트 유형을 판단하고,
> 아래 **Option A** 또는 **Option B** 중 하나만 선택하여 수행한다.

### 프로젝트 유형 판별 기준 (필수)

- **Option A 선택**: 루트 디렉터리에 `.sln` 또는 `.csproj` 파일이 존재하는 경우
  - *참고: `.csproj` 파일 내용에 `Sdk="Microsoft.NET.Sdk.Web"`이 포함된 경우 **ASP.NET 프로젝트**로 간주한다.*
- **Option B 선택**: 루트 디렉터리에 `build.gradle` 또는 `build.gradle.kts` 파일이 존재하는 경우
- **중단 및 요청**: 두 조건이 모두 해당되거나, 판단이 불가능한 경우
  - 작업을 즉시 중단한다.
  - 사용자에게 프로젝트 유형 확인을 요청한다.

---

### Option A: C# / .NET (Console / Library / ASP.NET) 프로젝트 (Windows)

- **주요 언어 / 프레임워크**: C#, .NET, ASP.NET Core
- **패키지 매니저**: NuGet
- **빌드 명령어**: `dotnet build`
- **테스트 명령어**: `dotnet test`
- **린트 / 포맷 명령어**: `dotnet format`
- **포맷 규칙**:
  - 수정된 파일 범위 내에서만 적용한다.
  - 전체 프로젝트 포맷팅은 금지한다.

---

### Option B: Kotlin / Android 프로젝트 (Windows)

- **주요 언어 / 프레임워크**: Kotlin, Android SDK
- **패키지 매니저**: Gradle
- **필수 환경**:
  - JDK가 설치되어 있어야 한다.
  - Android SDK가 구성된 환경에서만 실행한다.
- **빌드 명령어**: `./gradlew assembleDebug`
- **테스트 명령어**: `./gradlew test`
- **린트 / 포맷 명령어**: `./gradlew lint`
- **린트 규칙**:
  - 수정된 모듈 또는 파일 범위 기준으로 결과를 확인한다.
  - 린트 경고를 무시하지 않는다.

---

### 공통 규칙 (필수)

- 선택되지 않은 Option의 명령어는 절대 실행하지 않는다.
- 명령 실행이 실패한 경우:
  - 실패 원인만 간단히 정리한다.
  - 환경 설정 변경 등의 임의 수정은 금지한다.
  - 사용자 승인 후에만 조치한다.

---

## 작업 원칙 (필수)

- 사용자가 **요청한 기능/동작/API/설정 변경 범위만** 수정한다.
- 사용자가 요청하지 않은 **기능 확장, 동작 변경, 구조 변경**은 절대 수행하지 않는다.
- 모든 문서 및 설명은 한글로 작성한다.
- 추가 수정이 필요하다고 판단되면:
  - 수정 필요 사유를 **간단히 정리**해 사용자에게 요청한다.
  - 사용자 승인 없이는 적용하지 않는다.

---

## 문서 관리 원칙 (필수)

- 솔루션에 여러 프로젝트가 포함되어 있더라도 **문서는 프로젝트별로 관리**한다.
- 모든 프로젝트 내용을 하나의 `notes.md`, `README.md`에 통합 관리하는 방식은 **금지**한다.

---

## 파일 위치 규칙 (필수)

### 프로젝트 단위 문서

각 프로젝트 폴더 기준으로 다음 파일을 관리한다.

- `/<project>/notes.md`
  - 해당 프로젝트의 작업 이력
  - 최근 변경 사항
  - 미해결 이슈 및 주의 사항

- `/<project>/README.md`
  - 프로젝트 기능 목록
  - 실제 동작 방식
  - 설정 값
  - 외부 인터페이스 및 의존성
  - 제한 사항

### 솔루션 루트 문서 (선택)

- `/README.md`
  - 전체 솔루션 빌드/실행 방법
  - 공통 규칙
  - 포함된 프로젝트 목록 및 간단 설명
  - **개별 프로젝트의 상세 내용은 작성하지 않는다**

---

## 작업 시작 전 필수 확인 (필수)

작업을 시작하기 전에 반드시 다음을 수행한다.

1. **작업 대상 프로젝트 폴더 기준**으로 문서 확인
   - `<project>/notes.md` (요약/인덱스)
     - 이전 작업 요약, 최근 변경 요약, 미해결 이슈 요약
     - 상세 내용은 `notes.md`에 링크된 문서에서 확인
   - `<project>/README.md` (요약/인덱스)
     - 프로젝트 개요/기능/설정/외부 인터페이스의 핵심만 요약
     - 상세 내용은 `README.md`에 링크된 문서에서 확인

2. 여러 프로젝트를 동시에 수정하는 경우:
   - 변경이 발생한 **각 프로젝트별로**
     - `notes.md` 및 링크된 상세 문서 확인/갱신
     - `README.md` 및 링크된 상세 문서 확인/갱신

3. 확인 결과 정리
   - 현재 프로젝트 상태를 한 줄로 요약
   - 이번 작업이 기존 기능/동작에 영향을 주는지 여부 판단

---
## LSP 진단 수행 (필수)

- 코드 작성 중 또는 작성 직후 **LSP(Language Server Protocol) 진단을 반드시 확인**한다.
- 문법 오류, 타입 오류, 명백한 경고는 **작업 종료 전에 모두 해결**한다.
- LSP 진단은 **사전 품질 점검 단계**이며, 빌드/테스트를 대체하지 않는다.
- LSP 진단 결과가 남아 있는 상태에서는 작업 완료로 간주하지 않는다.

---

## 품질 보장 예외 규칙 (필수)

다음 항목은 **사전 승인 없이 허용되는 자율 품질 개선**으로 간주한다.

- 변경한 코드가 **빌드, 타입 체크, 테스트, 린트**를 통과하도록 필요한 최소 수정
- 변경한 코드에 대해 **최소 범위의 회귀 방지 테스트 추가 또는 수정**
- 명백한 컴파일 오류, 런타임 오류, 테스트 실패 수정

단, 아래 항목은 **사전 승인 없이는 금지**한다.

- 요구사항과 무관한 리팩토링
- 코드 정리 목적의 대규모 수정
- 기능 추가 또는 동작 범위 확장
- 의존성 추가, 파일 구조 변경

---

## 작업 종료 후 필수 수행

### notes.md 작성 규칙 (필수)

- `notes.md`는 **요약(인덱스) 파일**로만 유지한다. (토큰/길이 제한 대응)
- 상세 작업 기록은 별도 파일로 분리하여 누적한다.
- `notes.md`가 존재하면 **반드시 먼저 읽고** 기존 요약과 링크를 확인한다.
- 프로젝트 루트에 없으면 새로 생성한다.
- UTF-8 인코딩 사용

#### 파일 구조(필수)

- `<project>/notes.md` (요약/인덱스)
- `<project>/docs/notes/`
  - `YYYY-MM.md` : 월별 작업 로그(상세)
  - 월별 작업 로그에 추가되는 작업 내용이 많은 경우 `YYYY-MM-DD_<topic>.md` : 작업 단위 상세 로그

#### notes.md(요약/인덱스) 필수 포함

- 최근 변경 요약(최근 N건)
- 미해결 이슈 요약
- 주의 사항 요약
- **상세 로그 링크 목록** (예: `docs/notes/2026-02.md`)

#### 상세 로그(별도 파일) 기록 형식

- 작업 일자
- 수행한 작업 요약
- 변경된 파일 목록
- 검증 결과 (빌드 / 테스트 / 린트)
- 이슈 및 조치 사항
- 제한 사항

#### 재수정 시(상세 로그에) 필수 기록

- 이전 잘못된 수정 내용, 문제 원인, 바로잡은 방법
- 동일 실수 방지 문구

---
### README.md 작성 규칙 (필수)

- `README.md`는 **요약(인덱스) 파일**로만 유지한다. (토큰/길이 제한 대응)
- 상세 설명(아키텍처/흐름/설정/API 등)은 별도 문서로 분리한다.
- `README.md`가 존재하면 **반드시 읽고** 현재 프로젝트 요약과 링크를 확인한다.
- 프로젝트 루트에 없으면 새로 생성한다.
- **기능/동작/설정/외부 인터페이스 변경 시**
  - `README.md`의 요약을 갱신하고
  - 해당 상세 문서도 함께 갱신한다.
- UTF-8 인코딩 사용
- 더 이상 존재하지 않는 기능 설명은 삭제, 추측성 설명 금지

#### 파일 구조(필수)

- `<project>/README.md` (요약/인덱스)
- `<project>/docs/readme/`
  - `architecture.md` : 아키텍처/클래스 구조(상세)
  - `flow.md` : 동작 흐름(상세)
  - `configuration.md` : 설정(상세)
  - `interfaces.md` : 외부 인터페이스(API/입출력)(상세)
  - `changelog.md` : 변경 이력(상세)
  - `performance.md` : 성능/최적화(상세)
  - `limitations.md` : 제한사항(상세)

#### README.md(요약/인덱스) 필수 포함

- 프로젝트 개요(짧게)
- 현재 기능 목록(핵심만)
- 실행/사용 방법(핵심만)
- 설정/외부 인터페이스 핵심 요약
- 알려진 제한사항 핵심 요약
- **상세 문서 링크 섹션** (위 docs/readme/*.md 링크)

---
## 검증 및 점검 (필수)

- 성능 병목 분석
- 메모리 누수 검증
- 최적화 여부 검증

---

## 코드 리뷰 수행 (필수)

- 코드 리뷰 기준에 따라 자체 리뷰 수행
- **심각한 문제는 수정 완료 후에만 작업 종료로 간주**

---

## 계획(Plan) 운영 규칙 (필수)

- **Plan 없이 진행**
  - 단순 버그 수정
  - 주석 추가
  - 테스트 보강(품질 보장 예외에 해당하는 경우)

- **Plan 필수**
- README.md, notes.md 파일을 먼저 확인해서 제한사항, 코드 작성시 주의사항 등이 있는지 확인해서 Plan 작성시 참고.(필수)
- 기능 추가
- 기존 동작 변경
- 외부 인터페이스(API, 설정, 입출력) 변경
- 파일 추가/삭제 또는 구조 변경  
- 이슈 수정이 크거나 복잡한 경우
- 이슈 수정이 여러 파일에 걸쳐 있는 경우
- 이슈 수정이 프로젝트 전반에 영향을 미치는 경우
- 이번 작업이 기존 기능/동작에 영향을 줄 가능성이 있는 경우
- 테스트 전략 또는 검증 절차 추가하고 실패에 대한 진행 절차 포함
- 파일의 코드 내용이 많아서 작업 범위가 클 경우 단계별로 나누어 코드 작성중 코드 내용이 분실되어 복구가 불가능한 상황을 방지하기 위해 Plan 작성(필수)
- Steps 예시:
  1. [단계1]
  2. [단계2]
  3. [단계3]

- Plan 작성 후 **사용자 승인**을 받아 작업한다.

---

## 코드 작성 원칙

- 코드가 명확하고 이해하기 쉬워야 한다.
- 장기 유지보수가 가능해야 한다.
- 해당 언어의 **최신 기능과 권장 스타일**을 따른다.
- **공식 문서 기준**을 준수한다.
- 코드에는 **한글 주석**을 작성한다.
- 검증되지 않은 코드나 예제는 사용하지 않는다.
- 불필요한 주석, 코드, 문서 작성 금지
- 중복 코드를 피하고 재사용 가능한 모듈로 작성한다.
- UI 템플릿, 리소스 등은 재사용이 가능 하도록 별도의 파일로 작성해서 사용한다.
- 리팩토링이 필요 없게 깔끔하게 코드를 작성한다.
---

## 리소스 및 메모리 관리

- 객체 생성/해제 시 메모리 누수가 발생하지 않도록 한다.
- 이벤트 핸들러는 사용 후 반드시 해제한다.
- 파일 핸들, 데이터베이스 연결, 소켓 등 시스템 리소스는 사용 후 즉시 명시적으로 해제한다.
- 해당 언어의 **권장 리소스 해제 패턴**(예: `using`, `try-with-resources`, `defer` 등)을 올바르게 구현한다.

---

## 파일 크기 및 구조 규칙

- 소스 코드 파일은 약 **1000라인 내외**로 유지한다.
- 초과 시 기능 단위로 리팩토링하여 분리한다.
- 테스트 코드 및 자동 생성 코드는 예외로 한다.
- 기능별로 클래스 파일을 분리한다.
- 하나의 파일에 과도한 클래스나 기능을 포함하지 않는다.
- 파일은 UTF-8 인코딩을 사용해서 저장한다.

---

## 명명 규칙

- 변수, 함수, 클래스, 상수, 파일명 등은 **해당 언어 및 프레임워크의 권장 명명 규칙(Naming Convention)**을 따른다.
- 약어는 의미가 명확한 경우에만 사용한다.

---

## 포맷팅

- 프로젝트에 **설정된 린터(Linter) 또는 포맷터(Formatter)가 있는 경우에만** 실행한다.
- 전체 프로젝트 포맷팅을 금지하며, **수정된 파일 범위 내에서만** 포맷팅을 수행한다.
- 별도의 설정이 없는 경우, 해당 언어의 표준 스타일 가이드를 준수한다.

---

## 코드 리뷰 기준

### 리뷰 체크리스트

- 가독성과 명확성
- 함수/변수 명명 적절성
- 중복 코드 여부
- 오류 처리 적절성
- 비밀 키 또는 API 키 노출 여부
- 입력 유효성 검사 여부
- 테스트 커버리지
- 성능 고려 사항

### 피드백 우선순위

1. 심각한 문제 (반드시 수정)
2. 경고 (수정 권장)
3. 개선 제안 (선택)

---

## 제약조건

- 주석, 코드, 문서 작성 시 불필요한 아이콘·이모티콘 사용 금지
- 추측성 구현 및 검증되지 않은 예제 작성 금지
- 불필요한 의존성 추가 금지
- 프로젝트 요구사항과 무관한 리팩토링 금지
- 승인 없는 기능 확장 및 동작 변경 금지
- 승인 없는 파일 구조 변경 금지
- 프로젝트 빌드/테스트/린트 실패 금지
- 작업 기록 누락 금지
- README.md 갱신 누락 금지
- 작업 전 notes.md 및 README.md 미확인 금지
- 자동 검증 조건 위반 금지
- 코드 리뷰 심각한 문제 미수정 금지
- Plan 미작성 또는 미승인 작업 금지
- 코드 작성 원칙 미준수 금지
- 메모리 관리 미준수 금지
- 파일 크기 및 구조 규칙 미준수 금지
- 명명 규칙 미준수 금지
- 코드 리뷰 기준 미준수 금지

---

## AGENTS.md 준수 확인 규칙 (필수)

### 작업 종료 전 자가 점검

작업 완료 전에 아래 항목을 반드시 확인한다.

- 범위 준수
  - [ ] 요청된 기능/동작/API/설정 범위만 수정했다
  - [ ] 요청되지 않은 기능 확장, 동작 변경, 구조 변경이 없다
- 사전 확인
  - [ ] 작업 시작 전 notes.md를 확인했다
  - [ ] 작업 시작 전 README.md를 확인했다
- 문서 기록
  - [ ] 코드 변경이 있는 경우 notes.md에 작업 기록을 추가했다
  - [ ] 기능/동작/설정/외부 인터페이스 변경이 있는 경우 README.md를 갱신했다
- 품질 및 금지 항목
  - [ ] 빌드/테스트/린트 통과를 위한 최소 수정만 수행했다
  - [ ] 승인 없는 리팩토링, 의존성 추가, 파일 구조 변경이 없다

### 증거 기록 (필수)

`notes.md` 작업 기록에 다음을 반드시 포함한다.

- 변경 파일 요약
- 빌드 / 테스트 / 린트 수행 여부 및 결과
- README.md 갱신 여부와 사유(해당 시)

### 자동 검증 연계 (필수)

CI에서 아래 조건을 위반하면 작업은 실패로 간주한다.

- 코드 변경이 있는데 notes.md 변경이 없는 경우
- 핵심 디렉터리(src / api / config / View / Model / ViewModel 등) 변경이 있는데 README.md 변경이 없는 경우
